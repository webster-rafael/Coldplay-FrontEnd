<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Coldplay</title>
    <link href="output.css" rel="stylesheet">
</head>
<body class="flex text-white items-center justify-center w-full h-screen font-dm bg-gradient-to-br from-gray-900 to-gray-900 mobile:bg-[url('/img/bg-login.jpg')] bg-center">
    <section class="w-4/6 h-[450px] rounded-2xl bg-gray-950 flex shadow-[0px_10px_15px] shadow-zinc-950 windscreen:w-3/6 mobile:w-[350px] mobile:h-[500px] tablet:w-5/6 tablet:h-[510px] windscreen:h-[500px]">
        <section class="w-5/12 flex flex-col mobile:w-full tablet:w-10/12" id="form">
            <form class="flex flex-col items-center" action="" id="loginForm">
                <h1 class="text-3xl font-bold text-white my-12">Conecte-se
                    <span class="inline-block w-3 h-3 bg-gradient-to-tr from[#4158D0] via-[#bc1eb2] to[#FFCC70] rounded-full"></span>
                </h1>

                <label class="flex flex-col w-4/6 pb-4 mobile:w-5/6 tablet:w-5/6">
                    <p class="pl-3 text-sm text-white opacity-85">Email</p>
                    <input class="w-full py-2 px-2 text-center text-sm bg-gray-900 border border-[#4158D0] border-t-[#4158D0] border-r-[#bc1eb2] border-b-[rgb(188,30,178)] rounded-full focus:border-2 focus:border-span appearance-none outline-none" type="email" id="email">
                </label>

                <label class="flex flex-col w-4/6 mobile:w-5/6 tablet:w-5/6">
                    <p class="pl-3 text-sm text-white opacity-85">Senha</p>
                    <input class="w-full py-2 px-2 text-sm text-center bg-gray-900 border border-[#4158D0] border-b-[#4158D0] border-r-[#bc1eb2] border-t-[#bc1eb2] rounded-full invalid:bg-red-700 focus:border-2 focus:border-span appearance-none outline-none" type="password" id="senha">
                    <span id="senhaError" class="text-xs text-red-700"></span>
                </label>
                <a class="flex justify-center text-xs ml-20 pt-1 pb-4 text-span font-sans underline hover:text-rosa mobile:w-full mobile:justify-center mobile:ml-0 tablet:justify-center tablet:ml-0" href="#">Esqueci minha senha</a>

                <button class="bg-gradient-to-tr from[#4158D0] via-[#bc1eb2] to[#000] w-4/6 py-1 rounded-xl hover:bg-gradient-to-tr hover:from-[#4158D0] hover:via-[#1EE0E1] hover:to-[#000] mobile:w-5/6 tablet:w-5/6" type="submit" id="entrarButton">Entrar</button>
                <div class="flex">
                    <p class="text-xs pr-1 pt-2 opacity-85">Não tem uma Conta?</p>
                    <a class="text-xs pl-1 pt-2 underline text-span hover:text-rosa
                    " href="./cadastro.html">Criar Conta</a>
                </div>

            </form>

            <div class="w-ful flex justify-center py-2 desktop:hidden">
                <img class="w-[100px]" src="../img/logo-removebg-preview.png" alt="">
            </div>
        </section>
        <section class="flex basis-7/12 bg-[url('/img/bg-login.jpg')] bg-center rounded-r-2xl shadow-[inset_300px_30px_600px_-100px_theme(colors.gray.950)] mobile:hidden" id="picture">
            <div class="w-full flex items-start justify-end pr-4 pt-4">
                <img class="w-[130px] rounded-full" src="../img/logo.jpg" alt="">
            </div>
        </section>
    </section>

    <!-- SCRIPT -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const loginForm = document.getElementById('loginForm');
            const senhaInput = document.getElementById('senha');
            const senhaError = document.getElementById('senhaError');
            const entrarButton = document.getElementById('entrarButton');
    
            loginForm.addEventListener('submit', function (event) {
                event.preventDefault(); // Evita o comportamento padrão do formulário
    
                const email = document.getElementById('email').value;
                const senha = senhaInput.value;
    
                // Remova classes de erro anteriores
                senhaInput.classList.remove('invalid:bg-red-700');
                senhaError.textContent = '';
    
                // Faça a solicitação para o seu backend
                fetch('http://localhost:3000/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password: senha })
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Autenticação falhou');
                    }
                    return response.json();
                })
                .then(data => {
                    // Se a autenticação for bem-sucedida, redirecione para index.html
                    window.location.href = './index.html';
                })
                .catch(error => {
                    // Se a autenticação falhar, você pode exibir uma mensagem de erro no input e alterar o texto do botão
                    senhaInput.classList.add('invalid:bg-red-700');
                    senhaError.textContent = 'Senha inválida';
                    
                    // Mude o texto e o estilo do botão
                    entrarButton.innerHTML = 'Error';
                    entrarButton.style.background = '#FF0000';  // Muda a cor de fundo diretamente para garantir
                });
            });
    
            // Adiciona um evento de foco ao campo de senha para redefinir o estilo do botão
            senhaInput.addEventListener('focus', function () {
                entrarButton.innerHTML = 'Entrar';
                entrarButton.style.background = 'linear-gradient(to top right, #000, #bc1eb2, #000)';
            });
        });
    </script>

</body>
</html>
